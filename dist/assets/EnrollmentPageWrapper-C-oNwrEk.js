import{j as e,g as a,u as n}from"./chat-Vz45qIYd.js";import{r as t}from"./ui-CcSG_NNb.js";import{T as r,c as o,C as s}from"./management-B5-K9R_t.js";import"./vendor-DEQ385Nk.js";import"./calendar-CdK-zQpj.js";const i=[{code:"MNL",name:"Metro Manila",region:"NCR"},{code:"ABR",name:"Abra",region:"CAR"},{code:"AGN",name:"Agusan del Norte",region:"Region XIII"},{code:"AGS",name:"Agusan del Sur",region:"Region XIII"},{code:"AKL",name:"Aklan",region:"Region VI"},{code:"ALB",name:"Albay",region:"Region V"},{code:"ANT",name:"Antique",region:"Region VI"},{code:"APA",name:"Apayao",region:"CAR"},{code:"AUR",name:"Aurora",region:"Region III"},{code:"BAS",name:"Basilan",region:"ARMM"},{code:"BAN",name:"Bataan",region:"Region III"},{code:"BTN",name:"Batanes",region:"Region II"},{code:"BTG",name:"Batangas",region:"Region IV-A"},{code:"BEN",name:"Benguet",region:"CAR"},{code:"BIL",name:"Biliran",region:"Region VIII"},{code:"BOH",name:"Bohol",region:"Region VII"},{code:"BUK",name:"Bukidnon",region:"Region X"},{code:"BUL",name:"Bulacan",region:"Region III"},{code:"CAG",name:"Cagayan",region:"Region II"},{code:"CAN",name:"Camarines Norte",region:"Region V"},{code:"CAS",name:"Camarines Sur",region:"Region V"},{code:"CAM",name:"Camiguin",region:"Region X"},{code:"CAP",name:"Capiz",region:"Region VI"},{code:"CAT",name:"Catanduanes",region:"Region V"},{code:"CAV",name:"Cavite",region:"Region IV-A"},{code:"CEB",name:"Cebu",region:"Region VII"},{code:"COM",name:"Compostela Valley",region:"Region XI"},{code:"DAV",name:"Davao del Norte",region:"Region XI"},{code:"DAS",name:"Davao del Sur",region:"Region XI"},{code:"DAC",name:"Davao Occidental",region:"Region XI"},{code:"DAO",name:"Davao Oriental",region:"Region XI"},{code:"DIN",name:"Dinagat Islands",region:"Region XIII"},{code:"EAS",name:"Eastern Samar",region:"Region VIII"},{code:"GUI",name:"Guimaras",region:"Region VI"},{code:"IFU",name:"Ifugao",region:"CAR"},{code:"ILN",name:"Ilocos Norte",region:"Region I"},{code:"ILS",name:"Ilocos Sur",region:"Region I"},{code:"ILO",name:"Iloilo",region:"Region VI"},{code:"ISA",name:"Isabela",region:"Region II"},{code:"KAL",name:"Kalinga",region:"CAR"},{code:"LAG",name:"Laguna",region:"Region IV-A"},{code:"LAN",name:"Lanao del Norte",region:"Region X"},{code:"LAS",name:"Lanao del Sur",region:"ARMM"},{code:"UNI",name:"La Union",region:"Region I"},{code:"LEY",name:"Leyte",region:"Region VIII"},{code:"MAG",name:"Maguindanao",region:"ARMM"},{code:"MAR",name:"Marinduque",region:"Region IV-B"},{code:"MAS",name:"Masbate",region:"Region V"},{code:"MSC",name:"Misamis Occidental",region:"Region X"},{code:"MSR",name:"Misamis Oriental",region:"Region X"},{code:"MOU",name:"Mountain Province",region:"CAR"},{code:"NEC",name:"Negros Occidental",region:"Region VI"},{code:"NER",name:"Negros Oriental",region:"Region VII"},{code:"NCO",name:"North Cotabato",region:"Region XII"},{code:"NSA",name:"Northern Samar",region:"Region VIII"},{code:"NUE",name:"Nueva Ecija",region:"Region III"},{code:"NUV",name:"Nueva Vizcaya",region:"Region II"},{code:"MDC",name:"Occidental Mindoro",region:"Region IV-B"},{code:"MDR",name:"Oriental Mindoro",region:"Region IV-B"},{code:"PAL",name:"Palawan",region:"Region IV-B"},{code:"PAM",name:"Pampanga",region:"Region III"},{code:"PAN",name:"Pangasinan",region:"Region I"},{code:"QUE",name:"Quezon",region:"Region IV-A"},{code:"QUI",name:"Quirino",region:"Region II"},{code:"RIZ",name:"Rizal",region:"Region IV-A"},{code:"ROM",name:"Romblon",region:"Region IV-B"},{code:"SAM",name:"Samar",region:"Region VIII"},{code:"SAR",name:"Sarangani",region:"Region XII"},{code:"SCO",name:"South Cotabato",region:"Region XII"},{code:"SLE",name:"Southern Leyte",region:"Region VIII"},{code:"SUK",name:"Sultan Kudarat",region:"Region XII"},{code:"SUL",name:"Sulu",region:"ARMM"},{code:"SUN",name:"Surigao del Norte",region:"Region XIII"},{code:"SUR",name:"Surigao del Sur",region:"Region XIII"},{code:"TAR",name:"Tarlac",region:"Region III"},{code:"TAW",name:"Tawi-Tawi",region:"ARMM"},{code:"ZMB",name:"Zambales",region:"Region III"},{code:"ZAN",name:"Zamboanga del Norte",region:"Region IX"},{code:"ZAS",name:"Zamboanga del Sur",region:"Region IX"},{code:"ZSI",name:"Zamboanga Sibugay",region:"Region IX"}],d={MNL:[{code:"MNL-QC",name:"Quezon City",provinceCode:"MNL"},{code:"MNL-MNL",name:"Manila",provinceCode:"MNL"},{code:"MNL-CAL",name:"Caloocan",provinceCode:"MNL"},{code:"MNL-LAS",name:"Las Piñas",provinceCode:"MNL"},{code:"MNL-MAK",name:"Makati",provinceCode:"MNL"},{code:"MNL-MAL",name:"Malabon",provinceCode:"MNL"},{code:"MNL-MAN",name:"Mandaluyong",provinceCode:"MNL"},{code:"MNL-MAR",name:"Marikina",provinceCode:"MNL"},{code:"MNL-MUN",name:"Muntinlupa",provinceCode:"MNL"},{code:"MNL-NAV",name:"Navotas",provinceCode:"MNL"},{code:"MNL-PAR",name:"Parañaque",provinceCode:"MNL"},{code:"MNL-PAS",name:"Pasay",provinceCode:"MNL"},{code:"MNL-PAT",name:"Pasig",provinceCode:"MNL"},{code:"MNL-PAZ",name:"Pateros",provinceCode:"MNL"},{code:"MNL-SJC",name:"San Juan",provinceCode:"MNL"},{code:"MNL-TAR",name:"Taguig",provinceCode:"MNL"},{code:"MNL-VAL",name:"Valenzuela",provinceCode:"MNL"}],CEB:[{code:"CEB-CEB",name:"Cebu City",provinceCode:"CEB"},{code:"CEB-LAP",name:"Lapu-Lapu",provinceCode:"CEB"},{code:"CEB-MAN",name:"Mandaue",provinceCode:"CEB"},{code:"CEB-TOL",name:"Toledo",provinceCode:"CEB"},{code:"CEB-BAN",name:"Banjao",provinceCode:"CEB"},{code:"CEB-CAR",name:"Carcar",provinceCode:"CEB"},{code:"CEB-DAN",name:"Danao",provinceCode:"CEB"},{code:"CEB-TAL",name:"Talisay",provinceCode:"CEB"}],LAG:[{code:"LAG-STA",name:"Sta. Rosa",provinceCode:"LAG"},{code:"LAG-BIN",name:"Biñan",provinceCode:"LAG"},{code:"LAG-CAB",name:"Cabuyao",provinceCode:"LAG"},{code:"LAG-CAL",name:"Calamba",provinceCode:"LAG"},{code:"LAG-LOS",name:"Los Baños",provinceCode:"LAG"},{code:"LAG-SAN",name:"San Pedro",provinceCode:"LAG"}],CAV:[{code:"CAV-BAC",name:"Bacoor",provinceCode:"CAV"},{code:"CAV-CAV",name:"Cavite City",provinceCode:"CAV"},{code:"CAV-DAS",name:"Dasmariñas",provinceCode:"CAV"},{code:"CAV-GEN",name:"General Trias",provinceCode:"CAV"},{code:"CAV-IMP",name:"Imus",provinceCode:"CAV"},{code:"CAV-TAG",name:"Tagaytay",provinceCode:"CAV"},{code:"CAV-TAN",name:"Tanza",provinceCode:"CAV"},{code:"CAV-TRE",name:"Trece Martires",provinceCode:"CAV"}]},l={"MNL-QC":[{code:"MNL-QC-BAG",name:"Bagong Pag-asa",cityCode:"MNL-QC"},{code:"MNL-QC-BAH",name:"Bahay Toro",cityCode:"MNL-QC"},{code:"MNL-QC-BAL",name:"Balingasa",cityCode:"MNL-QC"},{code:"MNL-QC-BAN",name:"Banlat",cityCode:"MNL-QC"},{code:"MNL-QC-BAR",name:"Barangka",cityCode:"MNL-QC"},{code:"MNL-QC-BAT",name:"Batasan Hills",cityCode:"MNL-QC"},{code:"MNL-QC-COM",name:"Commonwealth",cityCode:"MNL-QC"},{code:"MNL-QC-CUB",name:"Cubao",cityCode:"MNL-QC"},{code:"MNL-QC-DIL",name:"Diliman",cityCode:"MNL-QC"},{code:"MNL-QC-FAI",name:"Fairview",cityCode:"MNL-QC"},{code:"MNL-QC-KAM",name:"Kamuning",cityCode:"MNL-QC"},{code:"MNL-QC-LOY",name:"Loyola Heights",cityCode:"MNL-QC"},{code:"MNL-QC-NOV",name:"Novaliches",cityCode:"MNL-QC"},{code:"MNL-QC-PAY",name:"Payatas",cityCode:"MNL-QC"},{code:"MNL-QC-SAN",name:"San Francisco",cityCode:"MNL-QC"},{code:"MNL-QC-TAT",name:"Tandang Sora",cityCode:"MNL-QC"},{code:"MNL-QC-UP",name:"U.P. Campus",cityCode:"MNL-QC"}],"MNL-MNL":[{code:"MNL-MNL-BIN",name:"Binondo",cityCode:"MNL-MNL"},{code:"MNL-MNL-ERM",name:"Ermita",cityCode:"MNL-MNL"},{code:"MNL-MNL-INT",name:"Intramuros",cityCode:"MNL-MNL"},{code:"MNL-MNL-MAL",name:"Malate",cityCode:"MNL-MNL"},{code:"MNL-MNL-MAN",name:"Manila Bay",cityCode:"MNL-MNL"},{code:"MNL-MNL-PAC",name:"Paco",cityCode:"MNL-MNL"},{code:"MNL-MNL-PAN",name:"Pandacan",cityCode:"MNL-MNL"},{code:"MNL-MNL-POR",name:"Port Area",cityCode:"MNL-MNL"},{code:"MNL-MNL-QUI",name:"Quiapo",cityCode:"MNL-MNL"},{code:"MNL-MNL-RIZ",name:"Rizal Park",cityCode:"MNL-MNL"},{code:"MNL-MNL-SAN",name:"San Miguel",cityCode:"MNL-MNL"},{code:"MNL-MNL-STA",name:"Sta. Ana",cityCode:"MNL-MNL"},{code:"MNL-MNL-STC",name:"Sta. Cruz",cityCode:"MNL-MNL"},{code:"MNL-MNL-STM",name:"Sta. Mesa",cityCode:"MNL-MNL"},{code:"MNL-MNL-TON",name:"Tondo",cityCode:"MNL-MNL"}]};class c{static getProvinces(){return i.sort((e,a)=>e.name.localeCompare(a.name))}static getCitiesByProvince(e){return d[e]||[]}static getBarangaysByCity(e){return l[e]||[]}static searchProvinces(e){const a=e.toLowerCase();return i.filter(e=>e.name.toLowerCase().includes(a)||e.region.toLowerCase().includes(a)).sort((e,a)=>e.name.localeCompare(a.name))}static searchCities(e,a){const n=this.getCitiesByProvince(e),t=a.toLowerCase();return n.filter(e=>e.name.toLowerCase().includes(t)).sort((e,a)=>e.name.localeCompare(a.name))}static searchBarangays(e,a){const n=this.getBarangaysByCity(e),t=a.toLowerCase();return n.filter(e=>e.name.toLowerCase().includes(t)).sort((e,a)=>e.name.localeCompare(a.name))}static getProvinceByCode(e){return i.find(a=>a.code===e)||null}static getCityByCode(e){for(const a of Object.values(d)){const n=a.find(a=>a.code===e);if(n)return n}return null}static getBarangayByCode(e){for(const a of Object.values(l)){const n=a.find(a=>a.code===e);if(n)return n}return null}static calculateAge(e){const a=new Date,n=new Date(e);let t=a.getFullYear()-n.getFullYear();const r=a.getMonth()-n.getMonth();return(r<0||0===r&&a.getDate()<n.getDate())&&t--,t}static validatePhilippinePhone(e){const a=e.replace(/\D/g,"");return!(!a.startsWith("639")||12!==a.length)||(!(!a.startsWith("09")||11!==a.length)||!!(a.startsWith("02")&&a.length>=9&&a.length<=11))}static formatPhilippinePhone(e){const a=e.replace(/\D/g,"");return a.startsWith("639")&&12===a.length?`+63 ${a.slice(3,6)} ${a.slice(6,9)} ${a.slice(9)}`:a.startsWith("09")&&11===a.length?`${a.slice(0,4)} ${a.slice(4,7)} ${a.slice(7)}`:a.startsWith("02")?`(02) ${a.slice(2,5)}-${a.slice(5)}`:e}}const m=({address:a={},onChange:n,disabled:s=!1,className:i=""})=>{const[d]=t.useState(c.getProvinces()),[l,m]=t.useState([]),[u,g]=t.useState([]),[h,p]=t.useState(a.country||"Philippines"),[x,N]=t.useState(a.province||""),[b,y]=t.useState(a.city||""),[v,C]=t.useState(a.barangay||""),[L,M]=t.useState(a.addressLine1||""),[f,j]=t.useState(a.addressLine2||"");t.useEffect(()=>{if(x){const e=d.find(e=>e.name===x);if(e){const a=c.getCitiesByProvince(e.code);m(a),b&&!a.find(e=>e.name===b)&&(y(""),C(""),g([]))}}else m([]),y(""),C(""),g([])},[x,d,b]),t.useEffect(()=>{if(b){const e=l.find(e=>e.name===b);if(e){const a=c.getBarangaysByCity(e.code);g(a),v&&!a.find(e=>e.name===v)&&C("")}}else g([]),C("")},[b,l,v]),t.useEffect(()=>{n({country:h,province:x,city:b,barangay:v,addressLine1:L,addressLine2:f})},[h,x,b,v,L,f,n]);const A=o,I="block text-sm font-medium text-text-secondary dark:text-slate-400 mb-1";return e.jsxs("div",{className:`space-y-4 ${i}`,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"country",className:I,children:"Country"}),e.jsx(r,{id:"country",value:h,onChange:e=>p(e.target.value),disabled:s,required:!0,children:e.jsx("option",{value:"Philippines",children:"Philippines"})}),e.jsx("p",{className:"text-xs text-text-secondary dark:text-slate-400 mt-1",children:"Currently supporting Philippines addresses only"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"province",className:I,children:"Province/Region"}),e.jsxs(r,{id:"province",value:x,onChange:e=>N(e.target.value),disabled:s||"Philippines"!==h,required:!0,children:[e.jsx("option",{value:"",children:"Select Province/Region..."}),d.map(a=>e.jsxs("option",{value:a.name,children:[a.name," (",a.region,")"]},a.code))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city",className:I,children:"City/Municipality"}),e.jsxs(r,{id:"city",value:b,onChange:e=>y(e.target.value),disabled:s||!x,required:!0,children:[e.jsx("option",{value:"",children:x?"Select City/Municipality...":"Select Province first"}),l.map(a=>e.jsx("option",{value:a.name,children:a.name},a.code))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"barangay",className:I,children:"Barangay"}),e.jsxs(r,{id:"barangay",value:v,onChange:e=>C(e.target.value),disabled:s||!b,required:!0,children:[e.jsx("option",{value:"",children:b?"Select Barangay...":"Select City first"}),u.map(a=>e.jsx("option",{value:a.name,children:a.name},a.code))]}),0===u.length&&b&&e.jsx("p",{className:"text-xs text-text-secondary dark:text-slate-400 mt-1",children:"No barangays available for this city in our database. You may enter manually in Address Line 1."})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"addressLine1",className:I,children:["Street Address / Address Line 1 ",e.jsx("span",{className:"text-status-red",children:"*"})]}),e.jsx("input",{type:"text",id:"addressLine1",value:L,onChange:e=>M(e.target.value),className:A,placeholder:"e.g., 123 Main Street, Subdivision Name",disabled:s,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"addressLine2",className:I,children:"Address Line 2 (Optional)"}),e.jsx("input",{type:"text",id:"addressLine2",value:f,onChange:e=>j(e.target.value),className:A,placeholder:"e.g., Apartment, suite, unit, building, floor, etc.",disabled:s})]}),(x||b||v||L)&&e.jsxs("div",{className:"mt-4 p-3 bg-surface-subtle dark:bg-slate-800 rounded-md",children:[e.jsx("p",{className:"text-xs font-medium text-text-secondary dark:text-slate-400 mb-1",children:"Address Preview:"}),e.jsx("p",{className:"text-sm text-text-primary dark:text-slate-200",children:[L,f,v&&`Barangay ${v}`,b,x,h].filter(Boolean).join(", ")})]})]})},u=["Mother","Father","Grandmother","Grandfather","Aunt","Uncle","Sister","Brother","Cousin","Guardian","Foster Parent","Step-parent","Other"],g=({guardianType:a,guardian:n={},onChange:r,onRemove:s,disabled:i=!1,showRemoveButton:d=!1})=>{const[l,m]=t.useState(n.fullName||""),[g,h]=t.useState(n.relationship||""),[p,x]=t.useState(n.phone||""),[N,b]=t.useState(n.email||""),[y,v]=t.useState(n.facebook||""),[C,L]=t.useState(null),M=o,f="block text-sm font-medium text-text-secondary dark:text-slate-400 mb-1",j=e=>{const a={fullName:l,relationship:g,phone:p,email:N,facebook:y,...e};r(a)},A="primary"===a,I="primary"===a?"Primary Guardian/Parent":"Secondary Guardian/Parent";return e.jsxs("div",{className:"space-y-4 p-4 border border-surface-border dark:border-slate-700 rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"text-base font-semibold text-text-primary dark:text-slate-200",children:[I,A&&e.jsx("span",{className:"text-status-red ml-1",children:"*"})]}),d&&s&&e.jsx("button",{type:"button",onClick:s,className:"text-status-red hover:bg-status-red/10 p-1 rounded-md transition-colors",disabled:i,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:`${a}-fullName`,className:f,children:["Full Name ",A&&e.jsx("span",{className:"text-status-red",children:"*"})]}),e.jsx("input",{type:"text",id:`${a}-fullName`,value:l,onChange:e=>{return a=e.target.value,m(a),void j({fullName:a});var a},className:M,placeholder:"e.g., Maria Santos",disabled:i,required:A})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:`${a}-relationship`,className:f,children:["Relationship ",A&&e.jsx("span",{className:"text-status-red",children:"*"})]}),e.jsxs("select",{id:`${a}-relationship`,value:g,onChange:e=>{return a=e.target.value,h(a),void j({relationship:a});var a},className:M,disabled:i,required:A,children:[e.jsx("option",{value:"",children:"Select relationship..."}),u.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:`${a}-phone`,className:f,children:["Phone Number ","(Optional)"]}),e.jsx("input",{type:"tel",id:`${a}-phone`,value:p,onChange:e=>{return a=e.target.value,x(a),L(null),void j({phone:a});var a},onBlur:()=>{if(p&&!c.validatePhilippinePhone(p))L("Please enter a valid Philippine phone number");else if(p){const e=c.formatPhilippinePhone(p);x(e),j({phone:e})}},className:`${M} ${C?"border-status-red":""}`,placeholder:"e.g., 0917 123 4567",disabled:i}),C&&e.jsx("p",{className:"text-xs text-status-red mt-1",children:C}),e.jsx("p",{className:"text-xs text-text-secondary dark:text-slate-400 mt-1",children:"Philippine format: 09XX XXX XXXX or +63 9XX XXX XXXX"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`${a}-email`,className:f,children:"Email Address (Optional)"}),e.jsx("input",{type:"email",id:`${a}-email`,value:N,onChange:e=>{return a=e.target.value,b(a),void j({email:a});var a},className:M,placeholder:"e.g., maria.santos@email.com",disabled:i})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:`${a}-facebook`,className:f,children:"Facebook Profile (Optional)"}),e.jsx("input",{type:"text",id:`${a}-facebook`,value:y,onChange:e=>{return a=e.target.value,v(a),void j({facebook:a});var a},className:M,placeholder:"Facebook name or https://facebook.com/...",disabled:i})]})]}),"primary"===a&&e.jsxs("div",{className:"text-xs text-text-secondary dark:text-slate-400 bg-surface-subtle dark:bg-slate-800 p-3 rounded-md",children:[e.jsx("p",{className:"font-medium mb-1",children:"Primary Guardian Information:"}),e.jsx("p",{children:"This person will be contacted in case of emergencies and is the primary point of contact for the student."})]})]})},h=({primaryGuardian:a,secondaryGuardian:n,onPrimaryGuardianChange:r,onSecondaryGuardianChange:o,disabled:s=!1,isMinor:i=!1})=>{const[d,l]=t.useState(!!n);return e.jsxs("div",{className:"space-y-6",children:[i&&e.jsxs("div",{className:"text-sm text-status-yellow bg-status-yellow-light dark:bg-status-yellow/20 px-3 py-2 rounded-md",children:[e.jsx("p",{className:"font-medium",children:"Minor Student Detected"}),e.jsx("p",{children:"Guardian information is recommended for students under 18 years old."})]}),e.jsx(g,{guardianType:"primary",guardian:a,onChange:r,disabled:s}),d?e.jsx(g,{guardianType:"secondary",guardian:n,onChange:o,onRemove:()=>{l(!1),o(void 0)},disabled:s,showRemoveButton:!0}):e.jsxs("div",{className:"text-center",children:[e.jsx("button",{type:"button",onClick:()=>{l(!0),o({})},className:"px-4 py-2 bg-surface-main dark:bg-slate-700 border border-surface-border dark:border-slate-600 rounded-md text-text-primary dark:text-slate-200 hover:bg-black/5 dark:hover:bg-white/5 transition-colors",disabled:s,children:"+ Add Secondary Guardian/Parent"}),e.jsx("p",{className:"text-xs text-text-secondary dark:text-slate-400 mt-2",children:"Optional: Add a second emergency contact"})]})]})},p=e=>e.replace(/[^\d]/g,""),x=e=>c.validatePhilippinePhone(e),N=({instructors:n,students:i,onRequestEnrollment:d,successMessage:l})=>{const[u,g]=t.useState(!1),[N,b]=t.useState(""),[y,v]=t.useState(""),[C,L]=t.useState(""),[M,f]=t.useState(""),[j,A]=t.useState(0),[I,S]=t.useState(""),[k,R]=t.useState(n.length>0?n[0].id:""),[P,B]=t.useState(""),[X,V]=t.useState(""),[E,G]=t.useState(""),[w,O]=t.useState(""),[T,F]=t.useState(""),[Q,$]=t.useState({country:"Philippines",province:"",city:"",barangay:"",addressLine1:"",addressLine2:""}),[D,U]=t.useState({fullName:"",relationship:"",phone:"",email:"",facebook:""}),[q,Z]=t.useState(void 0),z=e=>{$({country:e.country||"Philippines",province:e.province||"",city:e.city||"",barangay:e.barangay||"",addressLine1:e.addressLine1||"",addressLine2:e.addressLine2||""})},K=e=>{U({fullName:e.fullName||"",relationship:e.relationship||"",phone:e.phone||"",email:e.email||"",facebook:e.facebook||""})},W=e=>{Z(e)},[Y,H]=t.useState(null),[J,_]=t.useState(null);t.useEffect(()=>{if(M){const e=c.calculateAge(M);A(e),B(e.toString())}},[M]);const ee=j>0&&j<18,ae=t.useMemo(()=>{if(!u||!N)return[];const e=i.find(e=>e.id===N);if(!e)return[];const a=e.parentStudentId||e.id,n=i.find(e=>e.id===a),t=n?[n.instrument]:[];return i.forEach(e=>{e.parentStudentId===a&&t.push(e.instrument)}),t},[N,i,u]),ne=t.useMemo(()=>u?a.filter(e=>!ae.includes(e)):a,[ae,u]),te=t.useMemo(()=>I?n.filter(e=>Array.isArray(e.specialty)&&e.specialty.includes(I)):n,[I,n]),re=t.useMemo(()=>!u||!!N,[u,N]);t.useEffect(()=>{I&&te.length>0?te.find(e=>e.id===k)||R(te[0].id):0===te.length&&R("")},[I,te,k]);const oe=e=>{g(e),e||(b(""),v(""),L(""),f(""),B(""),V(""),G(""),O(""),F(""),z({country:"Philippines",province:"",city:"",barangay:"",addressLine1:"",addressLine2:""}),K({fullName:"",relationship:"",phone:"",email:"",facebook:""}),W(void 0)),S(""),R(n.length>0?n[0].id:"")};t.useEffect(()=>{l&&(g(!1),b(""),v(""),L(""),f(""),S(""),R(n.length>0?n[0].id:""),B(""),V(""),G(""),O(""),F(""),z({country:"Philippines",province:"",city:"",barangay:"",addressLine1:"",addressLine2:""}),K({fullName:"",relationship:"",phone:"",email:"",facebook:""}),W(void 0),H(null),_(null))},[l,n]);const se=o,ie="block text-sm font-medium text-text-secondary dark:text-slate-400 mb-1";return e.jsx(s,{className:"max-w-3xl mx-auto",children:e.jsxs("form",{onSubmit:e=>{var a;if(e.preventDefault(),H(null),_(null),!(y.trim()&&I.trim()&&k&&X))return void H("Please fill out all required fields.");let n=j;if(!M&&P){if(n=parseInt(P,10),isNaN(n)||n<1)return void H("Please enter a valid age or birthdate.")}else if(!M&&!P)return void H("Please provide either a birthdate or age.");!u||N?(null==(a=Q.addressLine1)?void 0:a.trim())?!w||x(w)?!D.phone||x(D.phone)?!(null==q?void 0:q.phone)||x(q.phone)?d({name:y,nickname:C||void 0,birthdate:M||void 0,instrument:I,instructorId:k,age:n,gender:X,email:E||void 0,contactNumber:w?p(w):void 0,facebook:T||void 0,address:{country:Q.country,province:Q.province||void 0,city:Q.city||void 0,barangay:Q.barangay||void 0,addressLine1:Q.addressLine1,addressLine2:Q.addressLine2||void 0},guardianFullName:D.fullName||void 0,guardianPhone:D.phone?p(D.phone):void 0,guardianEmail:D.email||void 0,guardianFacebook:D.facebook||void 0,secondaryGuardian:q&&(q.fullName||q.phone||q.email)?{fullName:q.fullName||void 0,relationship:q.relationship||void 0,phone:q.phone?p(q.phone):void 0,email:q.email||void 0,facebook:q.facebook||void 0}:void 0,parentStudentId:u?N:void 0}):H("Please enter a valid Philippine phone number for the secondary guardian."):H("Please enter a valid Philippine phone number for the primary guardian."):_("Please enter a valid Philippine phone number."):H("Please provide at least the street address."):H("Please select an existing student.")},children:[e.jsxs("div",{className:"p-6 sm:p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-brand-secondary-deep-dark dark:text-brand-secondary mb-2",children:"New Student Enrollment"}),e.jsx("p",{className:"text-text-secondary dark:text-slate-400 mb-6",children:"Fill out the form below to register a new student in the system."}),Y&&e.jsx("div",{className:"bg-status-red-light dark:bg-status-red/20 border border-status-red/20 text-status-red px-4 py-3 rounded-md mb-4 font-medium",role:"alert",children:Y}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("fieldset",{className:"space-y-4 p-4 border border-surface-border dark:border-slate-700 rounded-md",children:[e.jsx("legend",{className:"text-lg font-semibold text-text-primary dark:text-slate-200 px-2",children:"Enrollment Type"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-800 transition-colors group",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"radio",name:"enrollmentType",value:"new",checked:!u,onChange:()=>oe(!1),className:"sr-only"}),e.jsx("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center transition-all "+(u?"border-gray-300 dark:border-slate-600 group-hover:border-blue-400":"bg-blue-500 border-blue-500 text-white"),children:!u&&e.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})]}),e.jsx("span",{className:"text-sm font-medium text-text-primary dark:text-slate-200 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:"New Student"})]}),e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-800 transition-colors group",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"radio",name:"enrollmentType",value:"existing",checked:u,onChange:()=>oe(!0),className:"sr-only"}),e.jsx("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center transition-all "+(u?"bg-blue-500 border-blue-500 text-white":"border-gray-300 dark:border-slate-600 group-hover:border-blue-400"),children:u&&e.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})]}),e.jsx("span",{className:"text-sm font-medium text-text-primary dark:text-slate-200 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:"Existing Student (Different Instrument)"})]})]})]}),u&&e.jsxs("fieldset",{className:"space-y-4 p-4 border border-surface-border dark:border-slate-700 rounded-md",children:[e.jsx("legend",{className:"text-lg font-semibold text-text-primary dark:text-slate-200 px-2",children:"Select Existing Student"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"existingStudent",className:ie,children:"Current Student"}),e.jsxs(r,{id:"existingStudent",value:N,onChange:e=>(e=>{var a;b(e);const n=i.find(a=>a.id===e);n&&(v(n.name),L(n.nickname||""),f(n.birthdate||""),B((null==(a=n.age)?void 0:a.toString())||""),V(n.gender||""),G(n.email||""),O(n.contactNumber||""),F(n.facebook||""),n.address?z({country:n.address.country||"Philippines",province:n.address.province||"",city:n.address.city||"",barangay:n.address.barangay||"",addressLine1:n.address.addressLine1||"",addressLine2:n.address.addressLine2||""}):z({country:"Philippines",province:"",city:"",barangay:"",addressLine1:"",addressLine2:""}),K({fullName:n.guardianFullName||"",relationship:"Parent",phone:n.guardianPhone||"",email:n.guardianEmail||"",facebook:n.guardianFacebook||""}),n.secondaryGuardian?W({fullName:n.secondaryGuardian.fullName||"",relationship:n.secondaryGuardian.relationship||"",phone:n.secondaryGuardian.phone||"",email:n.secondaryGuardian.email||"",facebook:n.secondaryGuardian.facebook||""}):W(void 0)),e||(S(""),R(""))})(e.target.value),required:u,children:[e.jsx("option",{value:"",children:"Choose a student..."}),i.filter(e=>"active"===e.status).sort((e,a)=>e.name.localeCompare(a.name)).map(a=>e.jsxs("option",{value:a.id,children:[a.name," - ",a.instrument," (ID: ",a.studentIdNumber,")"]},a.id))]}),u&&N&&e.jsx("p",{className:"text-xs text-text-secondary dark:text-slate-400 mt-1",children:"Student details have been auto-filled. You can select a new instrument and instructor below."})]})]}),e.jsxs("fieldset",{className:"space-y-4 p-4 border border-surface-border dark:border-slate-700 rounded-md",children:[e.jsx("legend",{className:"text-lg font-semibold text-text-primary dark:text-slate-200 px-2",children:"Student Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"studentName",className:ie,children:["Student Full Name ",e.jsx("span",{className:"text-status-red",children:"*"})]}),e.jsx("input",{type:"text",id:"studentName",value:y,onChange:e=>v(e.target.value),className:`${se} ${u?"bg-surface-subtle dark:bg-slate-800 text-text-secondary dark:text-slate-400":""}`,placeholder:"e.g., Jane Doe",required:!0,readOnly:u})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nickname",className:ie,children:"Nickname (Optional)"}),e.jsx("input",{type:"text",id:"nickname",value:C,onChange:e=>L(e.target.value),className:`${se} ${u?"bg-surface-subtle dark:bg-slate-800 text-text-secondary dark:text-slate-400":""}`,placeholder:"e.g., Janie",readOnly:u})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"birthdate",className:ie,children:["Birthdate ",0===j?e.jsx("span",{className:"text-status-red",children:"*"}):"(Optional)"]}),e.jsx("input",{type:"date",id:"birthdate",value:M,onChange:e=>f(e.target.value),className:`${se} ${u?"bg-surface-subtle dark:bg-slate-800 text-text-secondary dark:text-slate-400":""}`,readOnly:u}),M&&j>0&&e.jsxs("p",{className:"text-xs text-text-secondary dark:text-slate-400 mt-1",children:["Calculated age: ",j," years old"]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"age",className:ie,children:["Age ",M?"(Auto-calculated)":e.jsx("span",{className:"text-status-red",children:"*"})]}),e.jsx("input",{type:"number",id:"age",value:P,onChange:e=>B(e.target.value),className:`${se} ${u||M?"bg-surface-subtle dark:bg-slate-800 text-text-secondary dark:text-slate-400":""}`,placeholder:"e.g., 14",min:"1",required:!M,readOnly:u||!!M}),!M&&e.jsx("p",{className:"text-xs text-text-secondary dark:text-slate-400 mt-1",children:"Enter age manually or provide birthdate above for auto-calculation"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"gender",className:ie,children:["Gender ",e.jsx("span",{className:"text-status-red",children:"*"})]}),e.jsxs(r,{id:"gender",value:X,onChange:e=>V(e.target.value),required:!0,disabled:u,wrapperClassName:u?"bg-surface-subtle dark:bg-slate-800":"",children:[e.jsx("option",{value:"",disabled:!0,children:"Select gender..."}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"})]})]}),ee&&e.jsxs("div",{className:"text-sm text-status-yellow bg-status-yellow-light dark:bg-status-yellow/20 px-3 py-2 rounded-md",children:[e.jsx("p",{className:"font-medium",children:"Minor Student Detected"}),e.jsx("p",{children:"This student is under 18 years old. Guardian information is recommended for emergency contact."})]})]}),e.jsxs("fieldset",{className:"space-y-4 p-4 border border-surface-border dark:border-slate-700 rounded-md",children:[e.jsx("legend",{className:"text-lg font-semibold text-text-primary dark:text-slate-200 px-2",children:"Contact Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"email",className:ie,children:"Email Address (Optional)"}),e.jsx("input",{type:"email",id:"email",value:E,onChange:e=>G(e.target.value),className:`${se} ${u?"bg-surface-subtle dark:bg-slate-800 text-text-secondary dark:text-slate-400":""}`,placeholder:"e.g., jane.doe@example.com",readOnly:u})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"contactNumber",className:ie,children:"Student's Contact Number (Optional)"}),e.jsx("input",{type:"tel",id:"contactNumber",value:w,onChange:e=>O(e.target.value),onBlur:()=>!u&&O(e=>{return a=e,c.formatPhilippinePhone(a);var a}),className:`${se} ${J?"border-status-red":""} ${u?"bg-surface-subtle dark:bg-slate-800 text-text-secondary dark:text-slate-400":""}`,placeholder:"e.g., 0917 123 4567",readOnly:u}),J&&e.jsx("div",{className:"text-xs text-status-red mt-1",children:J}),e.jsx("p",{className:"text-xs text-text-secondary dark:text-slate-400 mt-1",children:"Philippine format: 09XX XXX XXXX or +63 9XX XXX XXXX (Optional)"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"facebook",className:ie,children:"Facebook Profile (Optional)"}),e.jsx("input",{type:"text",id:"facebook",value:T,onChange:e=>F(e.target.value),className:`${se} ${u?"bg-surface-subtle dark:bg-slate-800 text-text-secondary dark:text-slate-400":""}`,placeholder:"Facebook name or https://facebook.com/...",readOnly:u})]})]})]}),e.jsxs("fieldset",{className:"space-y-4 p-4 border border-surface-border dark:border-slate-700 rounded-md",children:[e.jsx("legend",{className:"text-lg font-semibold text-text-primary dark:text-slate-200 px-2",children:"Address Information"}),e.jsx("p",{className:"text-sm text-text-secondary dark:text-slate-400 -mt-2",children:"Complete address information for records and emergency contact."}),e.jsx(m,{address:Q,onChange:z,disabled:u})]}),e.jsxs("fieldset",{className:"space-y-4 p-4 border border-surface-border dark:border-slate-700 rounded-md",children:[e.jsx("legend",{className:"text-lg font-semibold text-text-primary dark:text-slate-200 px-2",children:"Guardian/Parent Information"}),e.jsx("p",{className:"text-sm text-text-secondary dark:text-slate-400 -mt-2",children:"Emergency contact information. Phone numbers are optional but recommended."}),e.jsx(h,{primaryGuardian:D,secondaryGuardian:q,onPrimaryGuardianChange:K,onSecondaryGuardianChange:W,disabled:u,isMinor:ee})]}),e.jsxs("fieldset",{className:"space-y-4 p-4 border border-surface-border dark:border-slate-700 rounded-md",children:[e.jsx("legend",{className:"text-lg font-semibold text-text-primary dark:text-slate-200 px-2",children:"Lesson Assignment"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"instrument",className:ie,children:"Instrument"}),e.jsxs(r,{id:"instrument",value:I,onChange:e=>S(e.target.value),required:!0,disabled:!re||u&&0===ne.length,children:[e.jsx("option",{value:"",disabled:!0,children:"Select an instrument..."}),ne.map(a=>e.jsx("option",{value:a,children:a},a)),u&&!N&&e.jsx("option",{disabled:!0,children:"Select an existing student first"}),u&&N&&0===ne.length&&e.jsx("option",{disabled:!0,children:"No new instruments available"})]}),u&&N&&e.jsx("p",{className:"text-xs text-text-secondary dark:text-slate-400 mt-1",children:"Instruments the student is already enrolled in are not shown."}),u&&!N&&e.jsx("p",{className:"text-xs text-text-secondary dark:text-slate-400 mt-1",children:"Select an existing student to choose an instrument."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"instructorId",className:ie,children:"Assign Instructor"}),e.jsx(r,{id:"instructorId",value:k,onChange:e=>R(e.target.value),required:!0,disabled:!re||!I||0===te.length,children:I&&te.length>0?te.map(a=>e.jsxs("option",{value:a.id,children:[a.name," (",a.specialty.join(", "),")"]},a.id)):e.jsx("option",{disabled:!0,children:I?"No instructors for this instrument":"Select an instrument first"})})]})]})]})]})]}),e.jsx("div",{className:"bg-surface-header dark:bg-slate-700/50 p-4 flex justify-end rounded-b-lg border-t border-surface-border dark:border-slate-700",children:e.jsx("button",{type:"submit",className:"px-6 py-2 rounded-md font-semibold text-text-on-color bg-brand-primary hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",disabled:0===n.length,children:u?"Enroll in New Instrument":"Enroll Student"})})]})})},b=()=>{const{activeInstructors:a,students:t,handleRequestEnrollment:r,enrollmentSuccessMessage:o}=n();return e.jsx(N,{instructors:a,students:t,onRequestEnrollment:r,successMessage:o})};export{b as EnrollmentPageWrapper};
